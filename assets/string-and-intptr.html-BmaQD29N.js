import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o as i,c,d as n,f as a,a as t,e}from"./app-BEaTdNAG.js";const l={},r=n("h2",{id:"字符串转指针",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#字符串转指针"},[n("span",null,"字符串转指针")])],-1),u={id:"marshal",tabindex:"-1"},d={class:"header-anchor",href:"#marshal"},h={href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.runtime.interopservices.marshal?view=net-8.0",target:"_blank",rel:"noopener noreferrer"},k=e(`<p>引用<code>using System.Runtime.InteropServices;</code>，具体查看C++提供的字符集编码</p><div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> str <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> strPtr<span class="token operator">=</span>Marshal<span class="token punctuation">.</span><span class="token function">StringToHGlobalUni</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),m={id:"marshal-copy",tabindex:"-1"},v={class:"header-anchor",href:"#marshal-copy"},g={href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.runtime.interopservices.marshal.copy?view=net-8.0",target:"_blank",rel:"noopener noreferrer"},b=e(`<div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> str <span class="token operator">=</span> <span class="token string">&quot;Hello World\\0&quot;</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> byteStr <span class="token operator">=</span> Encoding<span class="token punctuation">.</span>Unicode<span class="token punctuation">.</span><span class="token function">GetBytes</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">IntPtr</span> strPtr <span class="token operator">=</span> Marshal<span class="token punctuation">.</span><span class="token function">AllocHGlobal</span><span class="token punctuation">(</span>byteStr<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span>
Marshal<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>byteStr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> strPtr<span class="token punctuation">,</span> byteStr<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="指针转字符串" tabindex="-1"><a class="header-anchor" href="#指针转字符串"><span>指针转字符串</span></a></h2>`,2),y={id:"marshal-ptrtostringuni",tabindex:"-1"},_={class:"header-anchor",href:"#marshal-ptrtostringuni"},f={href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.runtime.interopservices.marshal.ptrtostringuni?view=net-6.0",target:"_blank",rel:"noopener noreferrer"},S=e(`<div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> str <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> strPtr<span class="token operator">=</span>Marshal<span class="token punctuation">.</span><span class="token function">StringToHGlobalUni</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> readStr <span class="token operator">=</span> Marshal<span class="token punctuation">.</span><span class="token function">PtrToStringUni</span><span class="token punctuation">(</span>strPtr<span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>readStr<span class="token punctuation">)</span>
</code></pre><div class="highlight-lines"><br><br><br><br><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),w={id:"encoding",tabindex:"-1"},M={class:"header-anchor",href:"#encoding"},C={href:"https://learn.microsoft.com/zh-cn/dotnet/api/system.text.encoding?view=net-8.0",target:"_blank",rel:"noopener noreferrer"},x=e(`<div class="language-csharp line-numbers-mode" data-ext="cs" data-title="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>InteropServices</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> str <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> strPtr<span class="token operator">=</span>Marshal<span class="token punctuation">.</span><span class="token function">StringToHGlobalUni</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">byte</span></span><span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
Marshal<span class="token punctuation">.</span><span class="token function">Copy</span><span class="token punctuation">(</span>strPtr<span class="token punctuation">,</span> bytes<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> readStr <span class="token operator">=</span> Encoding<span class="token punctuation">.</span>Unicode<span class="token punctuation">.</span><span class="token function">GetString</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>readStr<span class="token punctuation">)</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同理，其他类型也可以通过<code>Marshal.Copy</code>进行二进制编码转换</p>`,2);function T(P,q){const s=p("ExternalLinkIcon");return i(),c("div",null,[r,n("h3",u,[n("a",d,[n("span",null,[n("a",h,[a("Marshal"),t(s)])])])]),k,n("h2",m,[n("a",v,[n("span",null,[n("a",g,[a("Marshal.Copy"),t(s)])])])]),b,n("h3",y,[n("a",_,[n("span",null,[n("a",f,[a("Marshal.PtrToStringUni"),t(s)])])])]),S,n("h3",w,[n("a",M,[n("span",null,[n("a",C,[a("Encoding"),t(s)])])])]),x])}const E=o(l,[["render",T],["__file","string-and-intptr.html.vue"]]),R=JSON.parse('{"path":"/tools/csharp/string-and-intptr.html","title":"字符串和指针转换","lang":"zh-CN","frontmatter":{"title":"字符串和指针转换","date":"2024-02-28T00:00:00.000Z","editLink":false,"footer":false,"isOriginal":true,"category":["工具箱"],"tag":["C#","C++"],"description":"字符串转指针 Marshal 引用using System.Runtime.InteropServices;，具体查看C++提供的字符集编码 Marshal.Copy 指针转字符串 Marshal.PtrToStringUni Encoding 同理，其他类型也可以通过Marshal.Copy进行二进制编码转换","head":[["meta",{"property":"og:url","content":"https://ilyl.life/tools/csharp/string-and-intptr.html"}],["meta",{"property":"og:site_name","content":"乌龙茶有点甜"}],["meta",{"property":"og:title","content":"字符串和指针转换"}],["meta",{"property":"og:description","content":"字符串转指针 Marshal 引用using System.Runtime.InteropServices;，具体查看C++提供的字符集编码 Marshal.Copy 指针转字符串 Marshal.PtrToStringUni Encoding 同理，其他类型也可以通过Marshal.Copy进行二进制编码转换"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-02-28T09:04:30.000Z"}],["meta",{"property":"article:author","content":"乌龙茶"}],["meta",{"property":"article:tag","content":"C#"}],["meta",{"property":"article:tag","content":"C++"}],["meta",{"property":"article:published_time","content":"2024-02-28T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-02-28T09:04:30.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"字符串和指针转换\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-02-28T00:00:00.000Z\\",\\"dateModified\\":\\"2024-02-28T09:04:30.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"乌龙茶\\",\\"url\\":\\"https://ilyl.life\\",\\"email\\":\\"mailto:982474256@qq.com\\"}]}"]]},"headers":[{"level":2,"title":"字符串转指针","slug":"字符串转指针","link":"#字符串转指针","children":[{"level":3,"title":"Marshal","slug":"marshal","link":"#marshal","children":[]}]},{"level":2,"title":"Marshal.Copy","slug":"marshal-copy","link":"#marshal-copy","children":[]},{"level":2,"title":"指针转字符串","slug":"指针转字符串","link":"#指针转字符串","children":[{"level":3,"title":"Marshal.PtrToStringUni","slug":"marshal-ptrtostringuni","link":"#marshal-ptrtostringuni","children":[]},{"level":3,"title":"Encoding","slug":"encoding","link":"#encoding","children":[]}]}],"git":{"createdTime":1709111070000,"updatedTime":1709111070000,"contributors":[{"name":"乌龙茶","email":"982474256@qq.com","commits":1}]},"readingTime":{"minutes":0.62,"words":186},"filePathRelative":"tools/csharp/string-and-intptr.md","localizedDate":"2024年2月28日","excerpt":"<h2>字符串转指针</h2>\\n<h3><a class=\\"header-anchor\\" href=\\"#marshal\\"><span></span></a><a href=\\"https://learn.microsoft.com/zh-cn/dotnet/api/system.runtime.interopservices.marshal?view=net-8.0\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Marshal</a></h3>\\n<p>引用<code>using System.Runtime.InteropServices;</code>，具体查看C++提供的字符集编码</p>","autoDesc":true}');export{E as comp,R as data};
