import{_ as i}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as c,o as k,c as u,d as n,e as s,f as a,w as e}from"./app-Q32ETLnO.js";const d={},y={href:"https://learn.microsoft.com/zh-cn/previous-versions/dotnet/articles/ms973800(v=msdn.10)?redirectedfrom=MSDN",target:"_blank",rel:"noopener noreferrer"},w=n("p",null,"这里以C#调用VB为例",-1),m={class:"hint-container tip"},v=n("p",{class:"hint-container-title"},"提示",-1),b={href:"https://learn.microsoft.com/zh-cn/windows-server/administration/windows-commands/regsvr32",target:"_blank",rel:"noopener noreferrer"},g={href:"https://learn.microsoft.com/zh-cn/dotnet/framework/tools/regasm-exe-assembly-registration-tool",target:"_blank",rel:"noopener noreferrer"},_=n("figure",null,[n("img",{src:"https://nas.ilyl.life:8092/vb/vb5.gif",alt:"效果",width:"420",height:"200",tabindex:"0",loading:"lazy"}),n("figcaption",null,"效果")],-1),f=n("div",{class:"language-vb line-numbers-mode","data-ext":"vb"},[n("pre",{class:"language-vb"},[n("code",null,[n("span",{class:"token keyword"},"Option"),s(` Explicit

`),n("span",{class:"token keyword"},"Private"),s(),n("span",{class:"token keyword"},"Const"),s(" g_connString "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"Provider=SQLOLEDB.1;Data Source=...;Initial Catalog=...;Uid=...;Password=..."'),s(`

`),n("span",{class:"token keyword"},"Private"),s(" content "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),s(`
`),n("span",{class:"token keyword"},"Private"),s(" g_conn "),n("span",{class:"token keyword"},"As"),s(" ADODB"),n("span",{class:"token punctuation"},"."),s(`Connection
`),n("span",{class:"token keyword"},"Private"),s(" g_res "),n("span",{class:"token keyword"},"As"),s(" ADODB"),n("span",{class:"token punctuation"},"."),s(`Recordset

`),n("span",{class:"token keyword"},"Public"),s(),n("span",{class:"token keyword"},"Property"),s(),n("span",{class:"token keyword"},"Get"),s(" TestContent"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),s(`
    TestContent `),n("span",{class:"token operator"},"="),s(` content
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"Property"),s(`

`),n("span",{class:"token keyword"},"Public"),s(),n("span",{class:"token keyword"},"Property"),s(),n("span",{class:"token keyword"},"Let"),s(" TestContent"),n("span",{class:"token punctuation"},"("),s("vData "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),n("span",{class:"token punctuation"},")"),s(`
    content `),n("span",{class:"token operator"},"="),s(` vData
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"Property"),s(`

`),n("span",{class:"token keyword"},"Public"),s(),n("span",{class:"token keyword"},"Function"),s(" CRUD"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"ByVal"),s(" sSql "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"ByRef"),s(" errMsg "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(`
`),n("span",{class:"token keyword"},"On"),s(),n("span",{class:"token keyword"},"Error"),s(),n("span",{class:"token keyword"},"GoTo"),s(" ErrHandler"),n("span",{class:"token punctuation"},":"),s(`
CRUD `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),s(`
g_conn`),n("span",{class:"token punctuation"},"."),s("Execute sSql"),n("span",{class:"token punctuation"},","),s(` CRUD
`),n("span",{class:"token keyword"},"finally"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"Exit"),s(),n("span",{class:"token keyword"},"Function"),s(`
ErrHandler`),n("span",{class:"token punctuation"},":"),s(`
    errMsg `),n("span",{class:"token operator"},"="),s(" VBA"),n("span",{class:"token punctuation"},"."),s("Err"),n("span",{class:"token punctuation"},"."),s(`Description
    `),n("span",{class:"token keyword"},"GoTo"),s(),n("span",{class:"token keyword"},"finally"),s(`
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"Function"),s(`

`),n("span",{class:"token keyword"},"Public"),s(),n("span",{class:"token keyword"},"Function"),s(" Add"),n("span",{class:"token punctuation"},"("),s("errMsg "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(`
`),n("span",{class:"token keyword"},"On"),s(),n("span",{class:"token keyword"},"Error"),s(),n("span",{class:"token keyword"},"GoTo"),s(" ErrHandler"),n("span",{class:"token punctuation"},":"),s(`
`),n("span",{class:"token keyword"},"Dim"),s(" sSql "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),s(`
Add `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),s(`
sSql `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},`"Insert into Test(content) values ('"`),s(),n("span",{class:"token operator"},"&"),s(" TestContent "),n("span",{class:"token operator"},"&"),s(),n("span",{class:"token string"},`"')"`),s(`
g_conn`),n("span",{class:"token punctuation"},"."),s("Execute sSql"),n("span",{class:"token punctuation"},","),s(` Add
`),n("span",{class:"token keyword"},"finally"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"Exit"),s(),n("span",{class:"token keyword"},"Function"),s(`
ErrHandler`),n("span",{class:"token punctuation"},":"),s(`
   errMsg `),n("span",{class:"token operator"},"="),s(" VBA"),n("span",{class:"token punctuation"},"."),s("Err"),n("span",{class:"token punctuation"},"."),s(`Description
    `),n("span",{class:"token keyword"},"GoTo"),s(),n("span",{class:"token keyword"},"finally"),s(`
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"Function"),s(`

`),n("span",{class:"token keyword"},"Public"),s(),n("span",{class:"token keyword"},"Function"),s(" Query"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"ByVal"),s(" sSql "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),n("span",{class:"token punctuation"},","),s(" errMsg "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"As"),s(" ADODB"),n("span",{class:"token punctuation"},"."),s(`Recordset
`),n("span",{class:"token keyword"},"On"),s(),n("span",{class:"token keyword"},"Error"),s(),n("span",{class:"token keyword"},"GoTo"),s(" ErrHandler"),n("span",{class:"token punctuation"},":"),s(`
`),n("span",{class:"token keyword"},"If"),s(" g_res"),n("span",{class:"token punctuation"},"."),s("State "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token keyword"},"Then"),s(" g_res"),n("span",{class:"token punctuation"},"."),s(`Close
g_res`),n("span",{class:"token punctuation"},"."),s("Open sSql"),n("span",{class:"token punctuation"},","),s(" g_conn"),n("span",{class:"token punctuation"},","),s(" adOpenStatic"),n("span",{class:"token punctuation"},","),s(` adLockReadOnly
`),n("span",{class:"token keyword"},"Set"),s(" Query "),n("span",{class:"token operator"},"="),s(` g_res
`),n("span",{class:"token keyword"},"finally"),n("span",{class:"token punctuation"},":"),s(`
    `),n("span",{class:"token keyword"},"Exit"),s(),n("span",{class:"token keyword"},"Function"),s(`
ErrHandler`),n("span",{class:"token punctuation"},":"),s(`
     errMsg `),n("span",{class:"token operator"},"="),s(" VBA"),n("span",{class:"token punctuation"},"."),s("Err"),n("span",{class:"token punctuation"},"."),s(`Description
    `),n("span",{class:"token keyword"},"GoTo"),s(),n("span",{class:"token keyword"},"finally"),s(`
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"Function"),s(`

`),n("span",{class:"token keyword"},"Private"),s(),n("span",{class:"token keyword"},"Sub"),s(" Class_Initialize"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"If"),s(" g_conn "),n("span",{class:"token keyword"},"Is"),s(),n("span",{class:"token boolean"},"Nothing"),s(),n("span",{class:"token keyword"},"Then"),s(`
    `),n("span",{class:"token keyword"},"Set"),s(" g_conn "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"New"),s(" ADODB"),n("span",{class:"token punctuation"},"."),s(`Connection
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`
`),n("span",{class:"token keyword"},"If"),s(" g_conn"),n("span",{class:"token punctuation"},"."),s("State "),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},">"),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token keyword"},"Then"),s(`
    g_conn`),n("span",{class:"token punctuation"},"."),s(`Open g_connString
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`
`),n("span",{class:"token keyword"},"If"),s(" g_res "),n("span",{class:"token keyword"},"Is"),s(),n("span",{class:"token boolean"},"Nothing"),s(),n("span",{class:"token keyword"},"Then"),s(`
    `),n("span",{class:"token keyword"},"Set"),s(" g_res "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"New"),s(" ADODB"),n("span",{class:"token punctuation"},"."),s(`Recordset
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"Sub"),s(`

`),n("span",{class:"token keyword"},"Private"),s(),n("span",{class:"token keyword"},"Sub"),s(" Class_Terminate"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"If"),s(),n("span",{class:"token keyword"},"Not"),s(" g_res "),n("span",{class:"token keyword"},"Is"),s(),n("span",{class:"token boolean"},"Nothing"),s(),n("span",{class:"token keyword"},"Then"),s(`
    `),n("span",{class:"token keyword"},"If"),s(" g_res"),n("span",{class:"token punctuation"},"."),s("State "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token keyword"},"Then"),s(" g_res"),n("span",{class:"token punctuation"},"."),s(`Close
    `),n("span",{class:"token keyword"},"Set"),s(" g_res "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"Nothing"),s(`
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`
`),n("span",{class:"token keyword"},"If"),s(),n("span",{class:"token keyword"},"Not"),s(" g_conn "),n("span",{class:"token keyword"},"Is"),s(),n("span",{class:"token boolean"},"Nothing"),s(),n("span",{class:"token keyword"},"Then"),s(`
    `),n("span",{class:"token keyword"},"If"),s(" g_conn"),n("span",{class:"token punctuation"},"."),s("State "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token keyword"},"Then"),s(" g_conn"),n("span",{class:"token punctuation"},"."),s(`Close
    `),n("span",{class:"token keyword"},"Set"),s(" g_conn "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"Nothing"),s(`
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"Sub"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),h=n("div",{class:"language-csharp line-numbers-mode","data-ext":"cs"},[n("pre",{class:"language-csharp"},[n("code",null,[n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" t "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token constructor-invocation class-name"},[s("ATest"),n("span",{class:"token punctuation"},"."),s("DBClass")]),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" errMsg "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"string"),n("span",{class:"token punctuation"},"."),s("Empty"),n("span",{class:"token punctuation"},";"),s(`
t`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"set_TestContent"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"C#"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" ret "),n("span",{class:"token operator"},"="),s(" t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Add"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"ref"),s(" errMsg"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),s("ret "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"1"),s(),n("span",{class:"token punctuation"},"?"),s(),n("span",{class:"token string"},'"新增成功"'),s(),n("span",{class:"token punctuation"},":"),s(" errMsg"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token class-name"},[n("span",{class:"token keyword"},"var")]),s(" rest "),n("span",{class:"token operator"},"="),s(" t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Query"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"select * from test"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"ref"),s(" errMsg"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token keyword"},"while"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("rest"),n("span",{class:"token punctuation"},"."),s("EOF"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"{"),s(`
    Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"WriteLine"),n("span",{class:"token punctuation"},"("),s("rest"),n("span",{class:"token punctuation"},"."),s("Fields"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"id"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"."),s("Value "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},'"  "'),s(),n("span",{class:"token operator"},"+"),s(" rest"),n("span",{class:"token punctuation"},"."),s("Fields"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"content"'),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"."),s("Value"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    rest`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"MoveNext"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
t`),n("span",{class:"token operator"},"="),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},";"),s(`
Console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"ReadKey"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),E=n("p",null,"VB和C#互操作有很多细节部分：",-1),S=n("ol",null,[n("li",null,"定义好接口及数据交互部分"),n("li",null,[s("设置"),n("code",null,"二进制兼容")]),n("li",null,[s("Visual Basic 常用"),n("code",null,"DomDocument"),s("来处理数据")]),n("li",null,[s("C#不直接引用及注册VB动态链接库，而是使用"),n("code",null,"Interop."),s("文件")])],-1);function A(C,I){const o=c("ExternalLinkIcon"),r=c("RouterLink"),p=c("Tabs");return k(),u("div",null,[n("p",null,[n("a",y,[s("互操作"),a(o)]),s("是将代码进行抽象分离，供其它地方及语言使用，更多说明见"),a(r,{to:"/tools/csharp/com.html"},{default:e(()=>[s("COM")]),_:1})]),w,n("div",m,[v,n("p",null,[s("C#调用VB：在开发环境生产xxx.dll时自动注册，生产环境需要"),n("a",b,[s("regsvr32"),a(o)]),s("进行注册")]),n("p",null,[s("VB调用C#：需要将C#类库设置为互COM操作,开发环境自动注册，生产环境需要"),n("a",g,[s("regasm"),a(o)]),s("生成tlb文件。")])]),_,a(p,{id:"17",data:[{id:"vb"},{id:"cs"}]},{title0:e(({value:t,isActive:l})=>[s("vb")]),title1:e(({value:t,isActive:l})=>[s("cs")]),tab0:e(({value:t,isActive:l})=>[f]),tab1:e(({value:t,isActive:l})=>[h]),_:1}),E,S])}const B=i(d,[["render",A],["__file","Interop.html.vue"]]);export{B as default};
