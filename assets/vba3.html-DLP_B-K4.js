import{_ as c}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as u,o as i,c as k,a as l,w as a,e as p,d as n,f as s}from"./app-D4perfQr.js";const r={},d=p('<h2 id="模板说明" tabindex="-1"><a class="header-anchor" href="#模板说明"><span>模板说明</span></a></h2><p>需要统计出所有员工考勤打卡迟到或早退的问题，07：54-08：01早班迟到，19：54-20：01晚班迟到。</p><p>考勤统计显示内容如下:</p><table><thead><tr><th style="text-align:left;">工号</th><th style="text-align:left;">英文名</th><th style="text-align:left;">中文名</th><th style="text-align:left;">部门</th><th style="text-align:left;">职位</th><th style="text-align:left;">卡号</th><th style="text-align:left;">打卡时间</th></tr></thead><tbody><tr><td style="text-align:left;">0001</td><td style="text-align:left;">...</td><td style="text-align:left;">王一</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">2021-08-01 06:00:12</td></tr><tr><td style="text-align:left;">0001</td><td style="text-align:left;">...</td><td style="text-align:left;">王一</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">2021-08-01 11:31:21</td></tr><tr><td style="text-align:left;">0001</td><td style="text-align:left;">...</td><td style="text-align:left;">王一</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">2021-08-01 11:57:40</td></tr><tr><td style="text-align:left;">0001</td><td style="text-align:left;">...</td><td style="text-align:left;">王一</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">2021-08-01 17:03:00</td></tr><tr><td style="text-align:left;">0001</td><td style="text-align:left;">...</td><td style="text-align:left;">王一</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">2021-08-01 17:55:51</td></tr><tr><td style="text-align:left;">0001</td><td style="text-align:left;">...</td><td style="text-align:left;">王一</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">2021-08-01 20:01:04</td></tr><tr><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td><td style="text-align:left;">...</td></tr></tbody></table><h2 id="宏命令" tabindex="-1"><a class="header-anchor" href="#宏命令"><span>宏命令</span></a></h2><h3 id="参数" tabindex="-1"><a class="header-anchor" href="#参数"><span>参数</span></a></h3>',6),m=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"const"),s(" options"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"rNameCol"),n("span",{class:"token operator"},":"),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"rJobCol"),s(),n("span",{class:"token operator"},":"),n("span",{class:"token number"},"5"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"rTimeCol"),s(),n("span",{class:"token operator"},":"),n("span",{class:"token number"},"7"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"wNameCol"),s(),n("span",{class:"token operator"},":"),n("span",{class:"token number"},"9"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"wSCol"),s(),n("span",{class:"token operator"},":"),n("span",{class:"token number"},"10"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"wNameCol1"),s(),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"12"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"wTimeCol"),s(),n("span",{class:"token operator"},":"),n("span",{class:"token number"},"13"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"startRow"),s(),n("span",{class:"token operator"},":"),n("span",{class:"token number"},"4"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token literal-property property"},"jobs"),n("span",{class:"token operator"},":"),n("span",{class:"token punctuation"},"["),n("span",{class:"token string"},'"检验员"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"量测员"'),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),y=n("div",{class:"language-vb line-numbers-mode","data-ext":"vb","data-title":"vb"},[n("pre",{class:"language-vb"},[n("code",null,[n("span",{class:"token keyword"},"Const"),s(" rNameCol  "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"3"),s("    "),n("span",{class:"token comment"},"'姓名读取列"),s(`
`),n("span",{class:"token keyword"},"Const"),s(" rJobCol   "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"5"),s("    "),n("span",{class:"token comment"},"'职位读取列"),s(`
`),n("span",{class:"token keyword"},"Const"),s(" rTimeCol  "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"7"),s("    "),n("span",{class:"token comment"},"'打卡时间读取列"),s(`
`),n("span",{class:"token keyword"},"Const"),s(" wNameCol  "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"9"),s("    "),n("span",{class:"token comment"},"'姓名写入列"),s(`
`),n("span",{class:"token keyword"},"Const"),s(" wSCol     "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"10"),s("   "),n("span",{class:"token comment"},"'总次数写入列"),s(`
`),n("span",{class:"token keyword"},"Const"),s(" wNameCol1 "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"12"),s(`
`),n("span",{class:"token keyword"},"Const"),s(" wTimeCol  "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"13"),s(`
`),n("span",{class:"token keyword"},"Const"),s(" startRow  "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"4"),s("    "),n("span",{class:"token comment"},"'开始行"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),b=n("h3",{id:"辅助方法",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#辅助方法"},[n("span",null,"辅助方法")])],-1),v=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"EoL"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"time"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" stdTime "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s("Date"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"parse"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"2022-01-13 07:54:00"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(" Date"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"parse"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"2022-01-13 8:02:00"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(" Date"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"parse"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"2022-01-13 19:54:00"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(" Date"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"parse"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"2022-01-13 20:02:00"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" now "),n("span",{class:"token operator"},"="),s(" Date"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"parse"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"2022-01-13 "'),s(),n("span",{class:"token operator"},"+"),s(" time"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),s("now "),n("span",{class:"token operator"},">"),s(" stdTime"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"&&"),s(" stdTime"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},">"),s(" now"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"||"),s(),n("span",{class:"token punctuation"},"("),s("now "),n("span",{class:"token operator"},">"),s(" stdTime"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"&&"),s(" stdTime"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},">"),s(" now"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"checkArray"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("arr"),n("span",{class:"token punctuation"},","),s(" val")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" i "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<"),s(" arr"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("arr"),n("span",{class:"token punctuation"},"["),s("i"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"==="),s(" val"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getItem"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("obj"),n("span",{class:"token punctuation"},","),s(" val")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" i "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<"),s(" obj"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("obj"),n("span",{class:"token punctuation"},"["),s("i"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"."),s("Key "),n("span",{class:"token operator"},"==="),s(" val"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"return"),s(" obj"),n("span",{class:"token punctuation"},"["),s("i"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"undefined"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),w=p(`<p>@tab vba</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Function</span> EoL<span class="token punctuation">(</span><span class="token keyword">ByVal</span> time <span class="token keyword">As</span> <span class="token keyword">String</span><span class="token punctuation">)</span> <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Dim</span> stdTime <span class="token keyword">As</span> <span class="token keyword">Variant</span>
    stdTime <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;07:54:00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;8:02:00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;19:54:00&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;20:02:00&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">If</span> <span class="token punctuation">(</span>DateDiff<span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">,</span> stdTime<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">And</span> DateDiff<span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">,</span> stdTime<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
        EoL <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">ElseIf</span> <span class="token punctuation">(</span>DateDiff<span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">,</span> stdTime<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword">And</span> DateDiff<span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">,</span> stdTime<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">Then</span>
        EoL <span class="token operator">=</span> <span class="token number">2</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    EoL <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">End</span> <span class="token keyword">Function</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>:::</p><h3 id="统计方法" tabindex="-1"><a class="header-anchor" href="#统计方法"><span>统计方法</span></a></h3>`,4),g=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"getData"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"opt"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" dic "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" dicTemp "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" maxRow "),n("span",{class:"token operator"},"="),s(" ActiveSheet"),n("span",{class:"token punctuation"},"."),s("UsedRange"),n("span",{class:"token punctuation"},"."),s("Rows"),n("span",{class:"token punctuation"},"."),s("Count"),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" i "),n("span",{class:"token operator"},"="),s(" opt"),n("span",{class:"token punctuation"},"."),s("startRow"),n("span",{class:"token punctuation"},";"),s(" i "),n("span",{class:"token operator"},"<="),s(" maxRow"),n("span",{class:"token punctuation"},";"),s(" i"),n("span",{class:"token operator"},"++"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" curJob "),n("span",{class:"token operator"},"="),s(" ActiveSheet"),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("rJobCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("curJob "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"continue"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" hasExits "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"checkArray"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("jobs"),n("span",{class:"token punctuation"},","),s(" curJob"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("hasExits"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"continue"),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token keyword"},"let"),s(" curName "),n("span",{class:"token operator"},"="),s(" ActiveSheet"),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("rNameCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2"),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token keyword"},"let"),s(" curTime "),n("span",{class:"token operator"},"="),s(" ActiveSheet"),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("rTimeCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2"),n("span",{class:"token punctuation"},";"),s(`
    curTime `),n("span",{class:"token operator"},"="),s(" Application"),n("span",{class:"token punctuation"},"."),s("WorksheetFunction"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Text"),n("span",{class:"token punctuation"},"("),s("curTime"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"yyyy-MM-dd HH:mm:ss"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" curTimeValue "),n("span",{class:"token operator"},"="),s(" curTime"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" curTimeTemp "),n("span",{class:"token operator"},"="),s(" Application"),n("span",{class:"token punctuation"},"."),s("WorksheetFunction"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Text"),n("span",{class:"token punctuation"},"("),s("curTime"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"yyyy-MM-dd HH:00:00"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    curTime `),n("span",{class:"token operator"},"="),s(" Application"),n("span",{class:"token punctuation"},"."),s("WorksheetFunction"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Text"),n("span",{class:"token punctuation"},"("),s("curTime"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"HH:mm:ss"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" curKey "),n("span",{class:"token operator"},"="),s(" curName "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},'"|"'),s(),n("span",{class:"token operator"},"+"),s(" curTimeTemp"),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token keyword"},"let"),s(" curType "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"EoL"),n("span",{class:"token punctuation"},"("),s("curTime"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("curType "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"continue"),n("span",{class:"token punctuation"},";"),s(`

    `),n("span",{class:"token keyword"},"let"),s(" isMult "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" itemMain "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"getItem"),n("span",{class:"token punctuation"},"("),s("dic"),n("span",{class:"token punctuation"},","),s(" curKey"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("itemMain "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token keyword"},"undefined"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("itemMain"),n("span",{class:"token punctuation"},"."),s("Value "),n("span",{class:"token operator"},"<="),s(" curTimeValue"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        itemMain`),n("span",{class:"token punctuation"},"."),s("Value "),n("span",{class:"token operator"},"="),s(" curTimeValue"),n("span",{class:"token punctuation"},";"),s(`
        isMult `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},";"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        dic`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token literal-property property"},"Key"),n("span",{class:"token operator"},":"),s(" curKey"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token literal-property property"},"Value"),n("span",{class:"token operator"},":"),s(` curTimeValue
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" itemDetail "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"getItem"),n("span",{class:"token punctuation"},"("),s("dicTemp"),n("span",{class:"token punctuation"},","),s(" curName"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("itemDetail "),n("span",{class:"token operator"},"!=="),s(),n("span",{class:"token keyword"},"undefined"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("isMult"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token operator"},"++"),s("itemDetail"),n("span",{class:"token punctuation"},"."),s("Value"),n("span",{class:"token punctuation"},";"),s(`
        `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token keyword"},"let"),s(" newData "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token literal-property property"},"Key"),n("span",{class:"token operator"},":"),s(" curName"),n("span",{class:"token punctuation"},","),s(`
        `),n("span",{class:"token literal-property property"},"Value"),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"1"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
        dicTemp`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("newData"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"["),s("dic"),n("span",{class:"token punctuation"},","),s(" dicTemp"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),f=n("div",{class:"language-vb line-numbers-mode","data-ext":"vb","data-title":"vb"},[n("pre",{class:"language-vb"},[n("code",null,[n("span",{class:"token keyword"},"Private"),s(),n("span",{class:"token keyword"},"Function"),s(" GetData"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"ByRef"),s(" jobs "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Variant"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Variant"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"Dim"),s(" maxRow"),n("span",{class:"token punctuation"},","),s("i"),n("span",{class:"token punctuation"},","),s(" iTemp                 "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Long"),s(`                 
`),n("span",{class:"token keyword"},"Dim"),s(" curKey"),n("span",{class:"token punctuation"},","),s(" curName"),n("span",{class:"token punctuation"},","),s(" curJob         "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),s(`               
`),n("span",{class:"token keyword"},"Dim"),s(" curTime"),n("span",{class:"token punctuation"},","),s(" curTimeTemp"),n("span",{class:"token punctuation"},","),s(" curTimeValue"),n("span",{class:"token punctuation"},","),s(" temp      "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"String"),s(`    
`),n("span",{class:"token keyword"},"Dim"),s(" curType             "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Integer"),s(`
`),n("span",{class:"token keyword"},"Dim"),s(" isMult              "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Boolean"),s(`
`),n("span",{class:"token keyword"},"Dim"),s(" data"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"2"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(" matchJob   "),n("span",{class:"token keyword"},"As"),s(),n("span",{class:"token keyword"},"Variant"),s(`
maxRow `),n("span",{class:"token operator"},"="),s(" ActiveSheet"),n("span",{class:"token punctuation"},"."),s("UsedRange"),n("span",{class:"token punctuation"},"."),s("Rows"),n("span",{class:"token punctuation"},"."),s("Count    "),n("span",{class:"token comment"},"'最大有效行"),s(`

`),n("span",{class:"token keyword"},"Set"),s(" data"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"="),s(" CreateObject"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"scripting.dictionary"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"Set"),s(" data"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"="),s(" CreateObject"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"scripting.dictionary"'),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"For"),s(" i "),n("span",{class:"token operator"},"="),s(" startRow "),n("span",{class:"token keyword"},"To"),s(" maxRow "),n("span",{class:"token keyword"},"Step"),s(),n("span",{class:"token number"},"1"),s(`
    curJob `),n("span",{class:"token operator"},"="),s(" ActiveSheet"),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),s("item"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},","),s(" rJobCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s(`Value2
    `),n("span",{class:"token keyword"},"If"),s(),n("span",{class:"token punctuation"},"("),s("curJob "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"Then"),s(),n("span",{class:"token keyword"},"GoTo"),s(` goNext
    matchJob `),n("span",{class:"token operator"},"="),s(" Filter"),n("span",{class:"token punctuation"},"("),s("jobs"),n("span",{class:"token punctuation"},","),s(" curJob"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"If"),s(" UBound"),n("span",{class:"token punctuation"},"("),s("matchJob"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token keyword"},"Then"),s(),n("span",{class:"token keyword"},"GoTo"),s(" goRun "),n("span",{class:"token keyword"},"Else"),s(),n("span",{class:"token keyword"},"GoTo"),s(` goNext
goRun`),n("span",{class:"token punctuation"},":"),s(`
    curName `),n("span",{class:"token operator"},"="),s(" ActiveSheet"),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),s("item"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},","),s(" rNameCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s(`Value2
    curTime `),n("span",{class:"token operator"},"="),s(" ActiveSheet"),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),s("item"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},","),s(" rTimeCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s(`Value2

    curTime `),n("span",{class:"token operator"},"="),s(" Application"),n("span",{class:"token punctuation"},"."),s("WorksheetFunction"),n("span",{class:"token punctuation"},"."),s("Text"),n("span",{class:"token punctuation"},"("),s("curTime"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"yyyy-MM-dd HH:mm:ss"'),n("span",{class:"token punctuation"},")"),s(`
    curTimeValue `),n("span",{class:"token operator"},"="),s(` curTime
    curTimeTemp `),n("span",{class:"token operator"},"="),s(" Format"),n("span",{class:"token punctuation"},"("),s("curTime"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"yyyy-MM-dd HH:00:00"'),n("span",{class:"token punctuation"},")"),s(`
    curTime `),n("span",{class:"token operator"},"="),s(" Application"),n("span",{class:"token punctuation"},"."),s("WorksheetFunction"),n("span",{class:"token punctuation"},"."),s("Text"),n("span",{class:"token punctuation"},"("),s("curTime"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"HH:mm:ss"'),n("span",{class:"token punctuation"},")"),s(`
    curKey `),n("span",{class:"token operator"},"="),s(" curName "),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token string"},'"|"'),s(),n("span",{class:"token operator"},"+"),s(` curTimeTemp

    curType `),n("span",{class:"token operator"},"="),s(" EoL"),n("span",{class:"token punctuation"},"("),s("curTime"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"If"),s(" curType "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),s(),n("span",{class:"token keyword"},"Then"),s(),n("span",{class:"token keyword"},"GoTo"),s(` goNext

    isMult `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"False"),s(`
    `),n("span",{class:"token keyword"},"If"),s(),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("exists"),n("span",{class:"token punctuation"},"("),s("curKey"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"Then"),s(`
    temp `),n("span",{class:"token operator"},"="),s(" data"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"("),s("curKey"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token keyword"},"If"),s(),n("span",{class:"token punctuation"},"("),s("temp "),n("span",{class:"token operator"},"<"),n("span",{class:"token operator"},"="),s(" curTimeValue"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"Then"),s(`
        data`),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"("),s("curKey"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"="),s(` curTimeValue
        isMult `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token boolean"},"True"),s(`
    `),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`
    `),n("span",{class:"token keyword"},"Else"),s(`
    data`),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Add curKey"),n("span",{class:"token punctuation"},","),s(` curTimeValue
    `),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`

    `),n("span",{class:"token keyword"},"If"),s(),n("span",{class:"token punctuation"},"("),s("data"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("exists"),n("span",{class:"token punctuation"},"("),s("curName"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token keyword"},"Then"),s(`
    `),n("span",{class:"token keyword"},"If"),s(),n("span",{class:"token keyword"},"Not"),s(" isMult "),n("span",{class:"token keyword"},"Then"),s(`
        data`),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"("),s("curName"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"="),s(" data"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"("),s("curName"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"+"),s(),n("span",{class:"token number"},"1"),s(`
    `),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`
    `),n("span",{class:"token keyword"},"Else"),s(`
    data`),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Add curName"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token number"},"1"),s(`
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"If"),s(`
goNext`),n("span",{class:"token punctuation"},":"),s(`
`),n("span",{class:"token keyword"},"Next"),s(` i

GetData `),n("span",{class:"token operator"},"="),s(` data
`),n("span",{class:"token keyword"},"End"),s(),n("span",{class:"token keyword"},"Function"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),x=n("h3",{id:"结果显示",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#结果显示"},[n("span",null,"结果显示")])],-1),h=n("div",{class:"language-javascript line-numbers-mode","data-ext":"js","data-title":"js"},[n("pre",{class:"language-javascript"},[n("code",null,[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"setData"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("source"),n("span",{class:"token punctuation"},","),s("opt")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),s(`
    ActiveSheet`),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("startRow "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("wNameCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2 "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"姓名"'),n("span",{class:"token punctuation"},";"),s(`
    ActiveSheet`),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("startRow "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("wSCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2 "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"异常总次数"'),n("span",{class:"token punctuation"},";"),s(`
    ActiveSheet`),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("startRow "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("wNameCol1"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2 "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"姓名"'),n("span",{class:"token punctuation"},";"),s(`
    ActiveSheet`),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("startRow "),n("span",{class:"token operator"},"-"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("wTimeCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2 "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"异常时间"'),n("span",{class:"token punctuation"},";"),s(`

    source`),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"function"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ele"),n("span",{class:"token punctuation"},","),s(" index")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    ActiveSheet`),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("startRow"),n("span",{class:"token operator"},"+"),s("index"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("wNameCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2 "),n("span",{class:"token operator"},"="),s(" ele"),n("span",{class:"token punctuation"},"."),s("Key"),n("span",{class:"token punctuation"},";"),s(`
    ActiveSheet`),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("startRow"),n("span",{class:"token operator"},"+"),s("index"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("wSCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2 "),n("span",{class:"token operator"},"="),s(" ele"),n("span",{class:"token punctuation"},"."),s("Value"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

    source`),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"function"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("ele"),n("span",{class:"token punctuation"},","),s(" index")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"let"),s(" t "),n("span",{class:"token operator"},"="),s(" ele"),n("span",{class:"token punctuation"},"."),s("Key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"split"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"|"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    ActiveSheet`),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("startRow"),n("span",{class:"token operator"},"+"),s("index"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("wNameCol1"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2 "),n("span",{class:"token operator"},"="),s(" t"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
    ActiveSheet`),n("span",{class:"token punctuation"},"."),s("Cells"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"Item"),n("span",{class:"token punctuation"},"("),s("opt"),n("span",{class:"token punctuation"},"."),s("startRow"),n("span",{class:"token operator"},"+"),s("index"),n("span",{class:"token punctuation"},","),s(" opt"),n("span",{class:"token punctuation"},"."),s("wTimeCol"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("Value2 "),n("span",{class:"token operator"},"="),s(" ele"),n("span",{class:"token punctuation"},"."),s("Value"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),T=p(`<p>@tab vba</p><div class="language-vb line-numbers-mode" data-ext="vb" data-title="vb"><pre class="language-vb"><code><span class="token keyword">Private</span> <span class="token keyword">Sub</span> SetData<span class="token punctuation">(</span><span class="token keyword">ByRef</span> source <span class="token keyword">As</span> <span class="token keyword">Variant</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> item<span class="token punctuation">,</span>t <span class="token keyword">As</span> <span class="token keyword">Variant</span>
<span class="token keyword">Dim</span> i <span class="token keyword">As</span> <span class="token keyword">Long</span>
i <span class="token operator">=</span> startRow

ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>item<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> wNameCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> <span class="token string">&quot;姓名&quot;</span>
ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>item<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> wSCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> <span class="token string">&quot;异常总次数&quot;</span>
ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>item<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> wNameCol1<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> <span class="token string">&quot;姓名&quot;</span>
ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>item<span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> wTimeCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> <span class="token string">&quot;异常时间&quot;</span>

<span class="token keyword">For</span> <span class="token keyword">Each</span> item <span class="token keyword">In</span> source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keys
    ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>item<span class="token punctuation">(</span>i<span class="token punctuation">,</span> wNameCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> item
    ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>item<span class="token punctuation">(</span>i<span class="token punctuation">,</span> wSCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> source<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">Next</span>
i <span class="token operator">=</span> startRow
<span class="token keyword">For</span> <span class="token keyword">Each</span> item <span class="token keyword">In</span> source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>keys
    t <span class="token operator">=</span> Split<span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token string">&quot;|&quot;</span><span class="token punctuation">)</span>
    ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>item<span class="token punctuation">(</span>i<span class="token punctuation">,</span> wNameCol1<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> t<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    ActiveSheet<span class="token punctuation">.</span>Cells<span class="token punctuation">.</span>item<span class="token punctuation">(</span>i<span class="token punctuation">,</span> wTimeCol<span class="token punctuation">)</span><span class="token punctuation">.</span>Value2 <span class="token operator">=</span> source<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">Next</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>:::</p>`,3);function C(A,V){const o=u("Tabs");return i(),k("div",null,[d,l(o,{id:"205",data:[{id:"js"},{id:"vba"}]},{title0:a(({value:t,isActive:e})=>[s("js")]),title1:a(({value:t,isActive:e})=>[s("vba")]),tab0:a(({value:t,isActive:e})=>[m]),tab1:a(({value:t,isActive:e})=>[y]),_:1}),b,l(o,{id:"216",data:[{id:"js"}]},{title0:a(({value:t,isActive:e})=>[s("js")]),tab0:a(({value:t,isActive:e})=>[v]),_:1}),w,l(o,{id:"231",data:[{id:"js"},{id:"vba"}]},{title0:a(({value:t,isActive:e})=>[s("js")]),title1:a(({value:t,isActive:e})=>[s("vba")]),tab0:a(({value:t,isActive:e})=>[g]),tab1:a(({value:t,isActive:e})=>[f]),_:1}),x,l(o,{id:"242",data:[{id:"js"}]},{title0:a(({value:t,isActive:e})=>[s("js")]),tab0:a(({value:t,isActive:e})=>[h]),_:1}),T])}const S=c(r,[["render",C],["__file","vba3.html.vue"]]),I=JSON.parse('{"path":"/tools/excel/vba3.html","title":"考勤迟到早退统计","lang":"zh-CN","frontmatter":{"title":"考勤迟到早退统计","date":"2023-06-19T00:00:00.000Z","dir.order":3,"order":3,"editLink":false,"footer":false,"isOriginal":true,"category":["工具箱"],"tag":["EXCEL"],"description":"模板说明 需要统计出所有员工考勤打卡迟到或早退的问题，07：54-08：01早班迟到，19：54-20：01晚班迟到。 考勤统计显示内容如下: 宏命令 参数 辅助方法 @tab vba ::: 统计方法 结果显示 @tab vba :::","head":[["meta",{"property":"og:url","content":"https://ilyl.life/tools/excel/vba3.html"}],["meta",{"property":"og:site_name","content":"乌龙茶有点甜"}],["meta",{"property":"og:title","content":"考勤迟到早退统计"}],["meta",{"property":"og:description","content":"模板说明 需要统计出所有员工考勤打卡迟到或早退的问题，07：54-08：01早班迟到，19：54-20：01晚班迟到。 考勤统计显示内容如下: 宏命令 参数 辅助方法 @tab vba ::: 统计方法 结果显示 @tab vba :::"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-07-21T07:17:50.000Z"}],["meta",{"property":"article:author","content":"乌龙茶"}],["meta",{"property":"article:tag","content":"EXCEL"}],["meta",{"property":"article:published_time","content":"2023-06-19T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-07-21T07:17:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"考勤迟到早退统计\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-06-19T00:00:00.000Z\\",\\"dateModified\\":\\"2023-07-21T07:17:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"乌龙茶\\",\\"url\\":\\"https://ilyl.life\\",\\"email\\":\\"mailto:982474256@qq.com\\"}]}"]]},"headers":[{"level":2,"title":"模板说明","slug":"模板说明","link":"#模板说明","children":[]},{"level":2,"title":"宏命令","slug":"宏命令","link":"#宏命令","children":[{"level":3,"title":"参数","slug":"参数","link":"#参数","children":[]},{"level":3,"title":"辅助方法","slug":"辅助方法","link":"#辅助方法","children":[]},{"level":3,"title":"统计方法","slug":"统计方法","link":"#统计方法","children":[]},{"level":3,"title":"结果显示","slug":"结果显示","link":"#结果显示","children":[]}]}],"git":{"createdTime":1687159112000,"updatedTime":1689923870000,"contributors":[{"name":"乌龙茶","email":"982474256@qq.com","commits":2}]},"readingTime":{"minutes":3.36,"words":1008},"filePathRelative":"tools/excel/vba3.md","localizedDate":"2023年6月19日","excerpt":"<h2>模板说明</h2>\\n<p>需要统计出所有员工考勤打卡迟到或早退的问题，07：54-08：01早班迟到，19：54-20：01晚班迟到。</p>\\n<p>考勤统计显示内容如下:</p>\\n<table>\\n<thead>\\n<tr>\\n<th style=\\"text-align:left\\">工号</th>\\n<th style=\\"text-align:left\\">英文名</th>\\n<th style=\\"text-align:left\\">中文名</th>\\n<th style=\\"text-align:left\\">部门</th>\\n<th style=\\"text-align:left\\">职位</th>\\n<th style=\\"text-align:left\\">卡号</th>\\n<th style=\\"text-align:left\\">打卡时间</th>\\n</tr>\\n</thead>\\n<tbody>\\n<tr>\\n<td style=\\"text-align:left\\">0001</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">王一</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">2021-08-01 06:00:12</td>\\n</tr>\\n<tr>\\n<td style=\\"text-align:left\\">0001</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">王一</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">2021-08-01 11:31:21</td>\\n</tr>\\n<tr>\\n<td style=\\"text-align:left\\">0001</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">王一</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">2021-08-01 11:57:40</td>\\n</tr>\\n<tr>\\n<td style=\\"text-align:left\\">0001</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">王一</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">2021-08-01 17:03:00</td>\\n</tr>\\n<tr>\\n<td style=\\"text-align:left\\">0001</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">王一</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">2021-08-01 17:55:51</td>\\n</tr>\\n<tr>\\n<td style=\\"text-align:left\\">0001</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">王一</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">2021-08-01 20:01:04</td>\\n</tr>\\n<tr>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n<td style=\\"text-align:left\\">...</td>\\n</tr>\\n</tbody>\\n</table>","autoDesc":true}');export{S as comp,I as data};
