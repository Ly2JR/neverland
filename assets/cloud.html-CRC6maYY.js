import{_ as d}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as c,o as r,c as p,d as e,e as o,f as i,w as s,b as l}from"./app-VsqfQe9P.js";const h={},u={href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"},g={href:"https://nginx.org/en/",target:"_blank",rel:"noopener noreferrer"},_=e("p",null,"以群晖为例:",-1),f=l('<h2 id="域名无法访问私有云" tabindex="-1"><a class="header-anchor" href="#域名无法访问私有云" aria-hidden="true">#</a> 域名无法访问私有云</h2><p><code>Q</code>：一切配置正常，解析正常，测试正常，但就是无法通过域名访问私有云?</p><p><code>A</code>：<code>80</code>和<code>443</code>端口不对个人开放，需要加上非<code>80</code>和<code>443</code>端口。</p><h2 id="私有云动态ip问题" tabindex="-1"><a class="header-anchor" href="#私有云动态ip问题" aria-hidden="true">#</a> 私有云动态IP问题</h2><p>域名绑定的是静态IP，但是私有云是动态的，体现在重启光猫后IP地址变动。</p>',5),m=e("li",null,[e("p",null,[o("在套件中心选择"),e("code",null,"Docker"),o("安装")])],-1),k=e("li",null,[e("p",null,[o("在注册表搜索"),e("code",null,"chenhw2/aliyun-ddns-cli:latest"),o(",并安装")])],-1),x={href:"https://ram.console.aliyun.com/overview",target:"_blank",rel:"noopener noreferrer"},S=e("code",null,"OpenApi调用访问",-1),w=e("figure",null,[e("img",{src:"https://nas.ilyl.life:8092/network/cloud1.png",alt:"添加新用户",width:"420",height:"200",tabindex:"0",loading:"lazy"}),e("figcaption",null,"添加新用户")],-1),y=l('<li><p>编辑基本信息，选择权限管理，个人权限，新增授权，选择<code>管理云解析(DNS)的权限</code></p><figure><img src="https://nas.ilyl.life:8092/network/cloud2.png" alt="授权" width="420" height="200" tabindex="0" loading="lazy"><figcaption>授权</figcaption></figure></li><li><p>记住新用户的<code>AccessKey ID</code>和<code>AccessKey Secret</code></p></li><li><p>在群晖Docker容器选项中，创建容器，选择<code>chenhw2/aliyun-ddns-cli:latest</code></p><figure><img src="https://nas.ilyl.life:8092/network/cloud3.png" alt="新建容器" width="420" height="200" tabindex="0" loading="lazy"><figcaption>新建容器</figcaption></figure></li><li><p>网络，选择默认<code>bridge</code></p><figure><img src="https://nas.ilyl.life:8092/network/cloud4.png" alt="网络" width="420" height="200" tabindex="0" loading="lazy"><figcaption>网络</figcaption></figure></li><li><p>常规设置，点击高级设置</p><p>AKID：对应用户的<code>AccessKey ID</code></p><p>AKSCT：应用用户的<code>AccessKey Secret</code></p><p>DOMAIN：对应自己的域名</p><figure><img src="https://nas.ilyl.life:8092/network/cloud5.png" alt="DNS同步" width="420" height="200" tabindex="0" loading="lazy"><figcaption>DNS同步</figcaption></figure></li>',5),D=l('<p>当前私有云地址变更时，会自动添加一条记录到阿里云的DNS解析里。</p><p>可以通过重启光猫，或者删除阿里云DNS所有解析，登录10分钟就能看到。</p><h2 id="私有云加域名和ssl" tabindex="-1"><a class="header-anchor" href="#私有云加域名和ssl" aria-hidden="true">#</a> 私有云加域名和SSL</h2><h3 id="nas配置" tabindex="-1"><a class="header-anchor" href="#nas配置" aria-hidden="true">#</a> NAS配置</h3><ol><li><p>登录门户</p><p>DSM端口(HTTP)：<code>自定义端口</code></p><p>DSM端口(HTTPS)：<code>自定义端口</code></p><p><code>勾选</code>自动将DSM桌面的HTTP连接重定向到HTTPS</p></li><li><p>安全性</p><ol><li><p>证书</p><p>新增，导入SSL证书</p><p>设置，证书选择导入的SSL证书</p></li><li><p>防火墙</p><p>配置出入站端口</p></li></ol></li></ol><h3 id="路由器配置" tabindex="-1"><a class="header-anchor" href="#路由器配置" aria-hidden="true">#</a> 路由器配置</h3><p>设置端口转发</p><h2 id="不输入端口访问私有云" tabindex="-1"><a class="header-anchor" href="#不输入端口访问私有云" aria-hidden="true">#</a> 不输入端口访问私有云</h2><div class="hint-container tip"><p class="hint-container-title">提示</p><p>子域名在主域名下，由于已经购买了一个域名，在解析设置时直接填写想要的子域名即可。</p><p>别忘了申请子域名对应的SSL证书。</p></div><p>需要明确的是，不输入端口是无法直接访问私有云的。</p><p>不能直接访问可以间接访问，通过输入主域名，跳转到子域名+端口上</p><p>例如：域名<code>a.com</code>，子域名<code>aa.a.com</code>，私有云内网IP<code>192.168.173.3:88</code>,公网域名:<code>aa.a.com:88</code></p><p>在浏览器上输入<code>a.com</code>自动跳转<code>aa.a.com:88</code>，也就解决了<code>域名无法访问私有云</code>的问题。</p>',13),T=e("p",null,[o("记录类型："),e("code",null,"显性URL-将域名重定向到另外一个地址")],-1),b=e("p",null,[o("主机记录："),e("code",null,"@")],-1),A=e("p",null,[o("记录值："),e("code",null,"302"),o(":"),e("code",null,"子域名加端口")],-1),I=e("figure",null,[e("img",{src:"https://nas.ilyl.life:8092/network/cloud6.png",alt:"显性URL",width:"420",height:"200",tabindex:"0",loading:"lazy"}),e("figcaption",null,"显性URL")],-1);function N(L,P){const n=c("ExternalLinkIcon"),t=c("Mermaid"),a=c("RouterLink");return r(),p("div",null,[e("p",null,[o("私有云部署离不开"),e("a",u,[o("Docker"),i(n)]),o("和"),e("a",g,[o("nginx"),i(n)])]),_,i(t,{id:"mermaid-6",code:"eJzT1dXlKsksyUm1Uni2tfH5im4ukEhaTn55ckZiUYmCTxAXl4JCcWlSelFiQYaCi18wkKug8HT+/KcTehV0dZ/N2PesYXlokI+urp3C07UTIBJWT1vXPN878fnq9U/7F0M0YJUCGgDUBRbwDEDXlJqXgmL3i+3rn0/Z+HTmCoiBqMZAGC/2rnnaPxFsaFsr1FAwA6ehfo5QDxGpPsCZkHIFkHpgOIH9huxmOBso83LGpueNq58umglSBHEDTmmglQA2sccB"}),f,e("ol",null,[m,k,e("li",null,[e("p",null,[o("进入阿里云"),e("a",x,[o("RAM访问控制"),i(n)]),o("添加新用户，勾选"),S]),w]),y]),D,e("p",null,[o("在"),i(a,{to:"/tools/nas/domain.html"},{default:s(()=>[o("域名配置")]),_:1}),o("上，其中有个解析设置，额外添加一条记录：")]),T,b,A,I])}const U=d(h,[["render",N],["__file","cloud.html.vue"]]);export{U as default};
