import{_ as p}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as d,o as r,c as u,d as s,e as a,f as l,w as n,b as o}from"./app-rSeson_6.js";const k={},v=o('<h2 id="说明" tabindex="-1"><a class="header-anchor" href="#说明" aria-hidden="true">#</a> 说明</h2><div class="hint-container tip"><p class="hint-container-title">提示</p><p>使用MSSQL数据库自带的功能，配置即可实现双向同步</p></div><h2 id="下载" tabindex="-1"><a class="header-anchor" href="#下载" aria-hidden="true">#</a> 下载</h2>',3),m={href:"https://dev.mysql.com/downloads/installer/",target:"_blank",rel:"noopener noreferrer"},b={href:"https://dev.mysql.com/downloads/connector/odbc/",target:"_blank",rel:"noopener noreferrer"},h=o('<h2 id="防火墙" tabindex="-1"><a class="header-anchor" href="#防火墙" aria-hidden="true">#</a> 防火墙</h2><div class="hint-container tip"><p class="hint-container-title">提示</p><p>MySql:3306端口</p></div><h2 id="mysql流程" tabindex="-1"><a class="header-anchor" href="#mysql流程" aria-hidden="true">#</a> MySql流程</h2><div class="hint-container warning"><p class="hint-container-title">注意</p><p>如果直接对目标表操作请忽略全部步骤，直接查看Sql Server流程</p></div><h3 id="中间库" tabindex="-1"><a class="header-anchor" href="#中间库" aria-hidden="true">#</a> 中间库</h3><p>该方式以中间库、表为中心流转，比较繁琐。</p><div class="hint-container tip"><p class="hint-container-title">提示</p><p>中间库名：TempDataBase</p><p>中间表名：SnapLink</p><p>目标表名：Snap</p></div><ul><li>表结构</li></ul><table><thead><tr><th style="text-align:left;">字段</th><th style="text-align:left;">类型</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">tag</td><td style="text-align:left;">varchar</td><td style="text-align:left;">标签</td></tr><tr><td style="text-align:left;">datetime</td><td style="text-align:left;">datetime</td><td style="text-align:left;">时间</td></tr><tr><td style="text-align:left;">cvalue</td><td style="text-align:left;">decimal</td><td style="text-align:left;">数据</td></tr></tbody></table><ul><li>脚本</li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>中间表和目标表结构保持一致</p></div>',11),g=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"Create"),a(),s("span",{class:"token keyword"},"database"),a(" TempDataBase"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),y=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"Create"),a(),s("span",{class:"token keyword"},"table"),a(),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),a("snap"),s("span",{class:"token punctuation"},"`")]),s("span",{class:"token punctuation"},"("),a(`
    `),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),a("tag"),s("span",{class:"token punctuation"},"`")]),a("       "),s("span",{class:"token keyword"},"varchar"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"100"),s("span",{class:"token punctuation"},")"),a(),s("span",{class:"token keyword"},"character"),a(),s("span",{class:"token keyword"},"set"),a(" utf8mb4 "),s("span",{class:"token keyword"},"collate"),a(" utf8mb4_0900_ai_ci "),s("span",{class:"token boolean"},"null"),a(),s("span",{class:"token keyword"},"default"),a(),s("span",{class:"token boolean"},"null"),s("span",{class:"token punctuation"},","),a(`
    `),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),a("datetime"),s("span",{class:"token punctuation"},"`")]),a("  "),s("span",{class:"token keyword"},"datetime"),a(),s("span",{class:"token boolean"},"null"),a(),s("span",{class:"token keyword"},"default"),a(),s("span",{class:"token boolean"},"null"),s("span",{class:"token punctuation"},","),a(`
    `),s("span",{class:"token identifier"},[s("span",{class:"token punctuation"},"`"),a("cvalue"),s("span",{class:"token punctuation"},"`")]),a("    "),s("span",{class:"token keyword"},"decimal"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"18"),s("span",{class:"token punctuation"},","),s("span",{class:"token number"},"2"),s("span",{class:"token punctuation"},")"),a(),s("span",{class:"token boolean"},"null"),a(),s("span",{class:"token keyword"},"default"),a(),s("span",{class:"token boolean"},"null"),a(`
`),s("span",{class:"token punctuation"},")"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1),_=s("ul",null,[s("li",null,"中间库账号")],-1),w=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"CREATE"),a(),s("span",{class:"token keyword"},"USER"),a(),s("span",{class:"token string"},"'demo'"),s("span",{class:"token variable"},"@'192.168.1.121'"),a(" IDENTIFIED "),s("span",{class:"token keyword"},"BY"),a(),s("span",{class:"token string"},"'demo'"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),q=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"DROP"),a(),s("span",{class:"token keyword"},"USER"),a(),s("span",{class:"token string"},"'demo'"),s("span",{class:"token variable"},"@'192.168.1.121'"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),E=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"GRANT"),a(),s("span",{class:"token keyword"},"SELECT"),a(),s("span",{class:"token keyword"},"ON"),a(" TempDataBase"),s("span",{class:"token punctuation"},"."),a("snap "),s("span",{class:"token keyword"},"to"),a(),s("span",{class:"token string"},"'demo'"),s("span",{class:"token variable"},"@'192.168.1.121'"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),x=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[a("flush "),s("span",{class:"token keyword"},"privileges"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),f=o(`<ul><li>远程访问表</li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>FEDEATED引擎规则：scheme://user_name[:password]@host_name[:port_num]/db_name/tbl_name</p></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">Create</span> <span class="token keyword">table</span> <span class="token identifier"><span class="token punctuation">\`</span>snaplink<span class="token punctuation">\`</span></span><span class="token punctuation">(</span>
    <span class="token identifier"><span class="token punctuation">\`</span>tag<span class="token punctuation">\`</span></span>       <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">character</span> <span class="token keyword">set</span> utf8mb4 <span class="token keyword">collate</span> utf8mb4_0900_ai_ci <span class="token boolean">null</span> <span class="token keyword">default</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>datetime<span class="token punctuation">\`</span></span>  <span class="token keyword">datetime</span> <span class="token boolean">null</span> <span class="token keyword">default</span> <span class="token boolean">null</span><span class="token punctuation">,</span>
    <span class="token identifier"><span class="token punctuation">\`</span>cvalue<span class="token punctuation">\`</span></span>    <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token boolean">null</span> <span class="token keyword">default</span> <span class="token boolean">null</span>
<span class="token punctuation">)</span><span class="token keyword">ENGINE</span><span class="token operator">=</span>FEDERATED CONNECTION<span class="token operator">=</span><span class="token string">&#39;mysql://demo:demo@192.168.1.104:3306/TempDataBase/snap&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>存储过程</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">delimiter</span> $$
<span class="token keyword">create</span> <span class="token keyword">procedure</span> proc_upload_to_temp<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">begin</span>
  <span class="token keyword">update</span> snap<span class="token punctuation">,</span>snaplink <span class="token keyword">set</span> snap<span class="token punctuation">.</span><span class="token keyword">datetime</span><span class="token operator">=</span>snaplink<span class="token punctuation">.</span><span class="token keyword">datetime</span><span class="token punctuation">,</span>
  snap<span class="token punctuation">.</span>cvalue<span class="token operator">=</span>snaplink<span class="token punctuation">.</span>cvalue
  <span class="token keyword">where</span> snap<span class="token punctuation">.</span>tag<span class="token operator">=</span>snaplink<span class="token punctuation">.</span>tag
<span class="token keyword">end</span>
<span class="token keyword">delimiter</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>调度</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> EVENT <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> upload_to_temp_event
<span class="token keyword">ON</span> SCHEDULE EVERY <span class="token number">15</span> <span class="token keyword">MINUTE</span>
<span class="token keyword">ON</span> COMPLETION PRESERVE <span class="token keyword">ENABLE</span>
<span class="token keyword">DO</span> <span class="token keyword">CALL</span> proc_upload_to_temp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="事件" tabindex="-1"><a class="header-anchor" href="#事件" aria-hidden="true">#</a> 事件</h3>`,8),S=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"SHOW"),a(" events"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),A=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"ALTER"),a(" EVENT upload_to_temp "),s("span",{class:"token keyword"},"ENABLE"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),T=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"ALTER"),a(" EVENT upload_to_temp "),s("span",{class:"token keyword"},"DISABLE"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),D=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"DROP"),a(" EVENT "),s("span",{class:"token keyword"},"IF"),a(),s("span",{class:"token keyword"},"EXISTS"),a(" upload_to_temp"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),N=s("h3",{id:"调度",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#调度","aria-hidden":"true"},"#"),a(" 调度")],-1),L=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"SHOW"),a(" VARIABLES "),s("span",{class:"token operator"},"LIKE"),a(),s("span",{class:"token string"},"'EVENT_SCHEDULER'"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),C=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"SET"),a(),s("span",{class:"token keyword"},"GLOBAL"),a(" EVENT_SCHEDULER "),s("span",{class:"token operator"},"="),a(),s("span",{class:"token keyword"},"ON"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),O=s("div",{class:"language-sql line-numbers-mode","data-ext":"sql"},[s("pre",{class:"language-sql"},[s("code",null,[s("span",{class:"token keyword"},"SET"),a(),s("span",{class:"token keyword"},"GLOBAL"),a(" EVENT_SCHEDULER "),s("span",{class:"token operator"},"="),a(),s("span",{class:"token keyword"},"OFF"),s("span",{class:"token punctuation"},";"),a(`
`)])]),s("div",{class:"line-numbers","aria-hidden":"true"},[s("div",{class:"line-number"})])],-1),B=o(`<h3 id="查看引擎" tabindex="-1"><a class="header-anchor" href="#查看引擎" aria-hidden="true">#</a> 查看引擎</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> ENGINES<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p>启用FEDERATED</p><ul><li><p>文件路径</p><p>默认 C:\\ProgramData\\MySQL\\MySQL Server 8.0\\my.ini</p></li><li><p>添加引擎</p><p>文件末尾添加<strong>federated</strong></p></li><li><p>重启mysql服务</p></li></ul></li></ul><h2 id="sql-server-流程" tabindex="-1"><a class="header-anchor" href="#sql-server-流程" aria-hidden="true">#</a> Sql Server 流程</h2><h3 id="配置odbc" tabindex="-1"><a class="header-anchor" href="#配置odbc" aria-hidden="true">#</a> 配置ODBC</h3><ul><li><p>打开ODBC</p><p>搜索<code>ODBC</code></p></li><li><p>添加系统数据源</p><p><code>系统DSN</code>-&gt;<code>添加</code>-&gt;<code>MySQL ODBC 8.0 Unicode Driver</code></p></li><li><p>配置系统数据源</p></li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>TCP/IP Server 为目标库或中间库的IP和端口</p></div><p>中间库配置示例:</p><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>|Data Srouce Name |MySql        |
|Description      |MySql        |
|TCP/IP Server    |192.168.1.104|
|Port             |3306         |
|User             |demo         |
|Password         |demo         |
|Database         |TempDataBase |
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置链接服务器" tabindex="-1"><a class="header-anchor" href="#配置链接服务器" aria-hidden="true">#</a> 配置链接服务器</h3><ul><li><p>新建链接服务器</p><p>路径：<code>服务器对象</code>-&gt;<code>链接服务器</code>; 选中右击新建</p></li><li><p>配置链接服务器</p></li></ul><p>常规:</p><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>|链接服务器(N)     |MySql                                     |
|服务器类型        |其他数据源                                 |
|提供程序(p)       |Microsoft OLE DB Provider for ODBC Drivers|
|数据源            |MySql                                     |
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安全性:</p><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>|远程登录(R)       |demo  |
|使用密码(P)       |demo  |
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div>`,15);function I(R,M){const c=d("ExternalLinkIcon"),i=d("Tabs");return r(),u("div",null,[v,s("p",null,[s("a",m,[a("MySql传送门"),l(c)])]),s("p",null,[s("a",b,[a("MySql ODBC传送门"),l(c)])]),h,l(i,{id:"119",data:[{id:"中间库"},{id:"中间表"}]},{title0:n(({value:e,isActive:t})=>[a("中间库")]),title1:n(({value:e,isActive:t})=>[a("中间表")]),tab0:n(({value:e,isActive:t})=>[g]),tab1:n(({value:e,isActive:t})=>[y]),_:1}),_,l(i,{id:"134",data:[{id:"创建账号"},{id:"删除账号"},{id:"账号授权"},{id:"刷新权限"}]},{title0:n(({value:e,isActive:t})=>[a("创建账号")]),title1:n(({value:e,isActive:t})=>[a("删除账号")]),title2:n(({value:e,isActive:t})=>[a("账号授权")]),title3:n(({value:e,isActive:t})=>[a("刷新权限")]),tab0:n(({value:e,isActive:t})=>[w]),tab1:n(({value:e,isActive:t})=>[q]),tab2:n(({value:e,isActive:t})=>[E]),tab3:n(({value:e,isActive:t})=>[x]),_:1}),f,l(i,{id:"180",data:[{id:"查看事件"},{id:"开启"},{id:"关闭"},{id:"删除"}]},{title0:n(({value:e,isActive:t})=>[a("查看事件")]),title1:n(({value:e,isActive:t})=>[a("开启")]),title2:n(({value:e,isActive:t})=>[a("关闭")]),title3:n(({value:e,isActive:t})=>[a("删除")]),tab0:n(({value:e,isActive:t})=>[S]),tab1:n(({value:e,isActive:t})=>[A]),tab2:n(({value:e,isActive:t})=>[T]),tab3:n(({value:e,isActive:t})=>[D]),_:1}),N,l(i,{id:"197",data:[{id:"查看调度"},{id:"开启"},{id:"关闭"}]},{title0:n(({value:e,isActive:t})=>[a("查看调度")]),title1:n(({value:e,isActive:t})=>[a("开启")]),title2:n(({value:e,isActive:t})=>[a("关闭")]),tab0:n(({value:e,isActive:t})=>[L]),tab1:n(({value:e,isActive:t})=>[C]),tab2:n(({value:e,isActive:t})=>[O]),_:1}),B])}const U=p(k,[["render",I],["__file","sqlserver-sync-to-mysql.html.vue"]]);export{U as default};
